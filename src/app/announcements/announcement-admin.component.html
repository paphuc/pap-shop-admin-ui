<div class="announcement-admin">
  <div class="header">
    <h1>Qu·∫£n L√Ω Th√¥ng B√°o</h1>
    <button class="btn-primary" (click)="openCreateForm()">
      + T·∫°o Th√¥ng B√°o M·ªõi
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <p>ƒêang t·∫£i...</p>
  </div>

  <!-- Form Modal -->
  <div class="modal" *ngIf="showForm">
    <div class="modal-content">
      <div class="modal-header">
        <h2>{{ isEditing ? 'Ch·ªânh S·ª≠a' : 'T·∫°o M·ªõi' }} Th√¥ng B√°o</h2>
        <button class="close-btn" (click)="closeForm()">√ó</button>
      </div>

      <form [formGroup]="announcementForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label>Ti√™u ƒë·ªÅ *</label>
          <input 
            type="text" 
            formControlName="title" 
            placeholder="Nh·∫≠p ti√™u ƒë·ªÅ th√¥ng b√°o"
            class="form-control">
          <div class="error" *ngIf="announcementForm.get('title')?.invalid && announcementForm.get('title')?.touched">
            Ti√™u ƒë·ªÅ l√† b·∫Øt bu·ªôc
          </div>
        </div>

        <div class="form-group">
          <label>N·ªôi dung *</label>
          <textarea 
            formControlName="message" 
            rows="4"
            placeholder="Nh·∫≠p n·ªôi dung th√¥ng b√°o"
            class="form-control"></textarea>
          <div class="error" *ngIf="announcementForm.get('message')?.invalid && announcementForm.get('message')?.touched">
            N·ªôi dung l√† b·∫Øt bu·ªôc
          </div>
        </div>

        <div class="form-group">
          <label>ID S·∫£n ph·∫©m (t√πy ch·ªçn)</label>
          <input 
            type="number" 
            formControlName="productId" 
            placeholder="Nh·∫≠p ID s·∫£n ph·∫©m n·∫øu c√≥"
            class="form-control">
          <small>ƒê·ªÉ tr·ªëng n·∫øu th√¥ng b√°o kh√¥ng li√™n quan ƒë·∫øn s·∫£n ph·∫©m c·ª• th·ªÉ</small>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-secondary" (click)="closeForm()">
            H·ªßy
          </button>
          <button type="submit" class="btn-primary" [disabled]="announcementForm.invalid">
            {{ isEditing ? 'C·∫≠p Nh·∫≠t' : 'T·∫°o M·ªõi' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Announcement List -->
  <div class="announcement-list" *ngIf="!loading">
    <div class="empty" *ngIf="announcements.length === 0">
      <p>Ch∆∞a c√≥ th√¥ng b√°o n√†o</p>
    </div>

    <table class="announcement-table" *ngIf="announcements.length > 0">
      <thead>
        <tr>
          <th>ID</th>
          <th>Ti√™u ƒë·ªÅ</th>
          <th>N·ªôi dung</th>
          <th>S·∫£n ph·∫©m</th>
          <th>Tr·∫°ng th√°i</th>
          <th>Ng√†y t·∫°o</th>
          <th>Thao t√°c</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let announcement of announcements">
          <td>{{ announcement.id }}</td>
          <td>{{ announcement.title }}</td>
          <td class="message-cell">{{ announcement.message }}</td>
          <td>
            <span *ngIf="announcement.productName">
              {{ announcement.productName }} (#{{ announcement.productId }})
            </span>
            <span *ngIf="!announcement.productName" class="text-muted">-</span>
          </td>
          <td>
            <span class="badge" [class.badge-active]="announcement.isActive" [class.badge-inactive]="!announcement.isActive">
              {{ announcement.isActive ? 'ƒêang hi·ªÉn th·ªã' : 'ƒê√£ ·∫©n' }}
            </span>
          </td>
          <td>{{ formatDate(announcement.createdAt) }}</td>
          <td class="actions">
            <button class="btn-icon btn-edit" (click)="openEditForm(announcement)" title="Ch·ªânh s·ª≠a">
              ‚úèÔ∏è
            </button>
            <button 
              class="btn-icon btn-toggle" 
              (click)="toggleActive(announcement)"
              [title]="announcement.isActive ? '·∫®n' : 'Hi·ªÉn th·ªã'">
              {{ announcement.isActive ? 'üëÅÔ∏è' : 'üö´' }}
            </button>
            <button class="btn-icon btn-delete" (click)="deleteAnnouncement(announcement.id)" title="X√≥a">
              üóëÔ∏è
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>